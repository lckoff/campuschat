<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<title>Campus Chat ‚Ä¢ Lyc√©e</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="style.css" rel="stylesheet" />
<script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script defer src="supabaseClient.js"></script>
<script defer src="script.js?v=6"></script>
</head>
<body>
<header class="navbar">
<div class="brand">Campus<span>Chat</span></div>
<nav>
<!-- Boutons visibles seulement si on n'est PAS connect√© -->
<div id="nav-auth">
<button id="btn-login" class="ghost">Se connecter</button>
<button id="btn-signup" class="primary">Cr√©er un compte</button>
</div>
<!-- Boutons visibles seulement si on EST connect√© -->
<div id="nav-inapp" class="hidden">
<button id="btn-directory" class="ghost">Annuaire</button>
</div>
</nav>
</header>

<!-- √âcran d‚Äôaccueil (masqu√© automatiquement si connect√©) -->
<section class="hero">
<h1>Relie tout le lyc√©e, simplement.</h1>
<p>Chat g√©n√©ral sans pub. Donn√©es h√©berg√©es en UE.</p>
<div class="cta">
<button id="hero-signup" class="primary large">Commencer</button>
<button id="hero-login" class="ghost large">J‚Äôai d√©j√† un compte</button>
</div>
<div class="scroll-cue">‚ñº</div>
</section>

<!-- Application -->
<section class="app hidden" id="app">
<aside class="sidebar">
<div class="me" id="me-card">
<div class="avatar" id="me-avatar"></div>
<div>
<div class="name" id="me-name">‚Äì</div>
<div class="class" id="me-class">‚Äì</div>
</div>
</div>

<div class="rooms">
<div class="room active" data-room="general"># g√©n√©ral</div>
</div>

<div class="actions">
<button id="btn-upload-proof" class="ghost">Envoyer preuve (facultatif)</button>
<button id="btn-logout" class="ghost">Se d√©connecter</button>
</div>
</aside>

<section class="chat">
<header class="chat-header">
<h2 id="room-title"># g√©n√©ral</h2>
</header>
<ul class="messages" id="messages"></ul>
<form class="composer" id="composer" autocomplete="off">
<input type="text" id="msg-input" placeholder="√âcrire un message‚Ä¶" maxlength="800" />
<button class="primary" id="btn-send" type="submit">Envoyer</button>
</form>
</section>
</section>

<!-- MODAL: Inscription -->
<dialog id="modal-signup">
<form method="dialog" class="modal-card" id="signup-form">
<h3>Cr√©er un compte</h3>
<div class="tos">
<h4>Conditions d‚Äôutilisation & confidentialit√©</h4>
<p>Nous stockons <strong>pr√©nom</strong>, <strong>nom</strong>, <strong>e-mail</strong> et <strong>classe</strong>
pour v√©rifier l‚Äôappartenance au lyc√©e et faire fonctionner le chat. La <strong>photo du carnet</strong> est
<strong>facultative</strong> (en cas de v√©rification) et <strong>supprim√©e automatiquement sous 72 h</strong>.
Donn√©es h√©berg√©es en UE, jamais revendues.</p>
<label class="checkbox"><input type="checkbox" id="chk-consent" required /> J‚Äôaccepte ces conditions</label>
</div>

<div class="grid">
<label>Pr√©nom<input type="text" id="su-first" required /></label>
<label>Nom<input type="text" id="su-last" required /></label>
<label>Classe<input type="text" id="su-class" placeholder="ex. 1√®re B" required /></label>
<label>E-mail<input type="email" id="su-email" autocomplete="email" required /></label>
<label>Mot de passe
<div class="pwd-wrap">
<input type="password" id="su-password" minlength="8" required />
<button type="button" id="su-toggle" class="icon-eye" aria-label="Afficher le mot de passe">üëÅ</button>
</div>
</label>
<label>Photo carnet (facult.)<input type="file" id="su-proof" accept="image/*" /></label>
</div>

<menu>
<button type="button" class="ghost close-modal">Annuler</button>
<button id="su-submit" class="primary" value="default">Cr√©er mon compte</button>
</menu>
<p class="hint">Un e-mail de v√©rification vous sera envoy√©.</p>
<div class="form-msg" id="su-msg"></div>
</form>
</dialog>

<!-- MODAL: Connexion -->
<dialog id="modal-login">
<form method="dialog" class="modal-card" id="login-form">
<h3>Se connecter</h3>
<label>E-mail<input type="email" id="li-email" autocomplete="email" required /></label>
<label>Mot de passe
<div class="pwd-wrap">
<input type="password" id="li-password" required />
<button type="button" id="li-toggle" class="icon-eye" aria-label="Afficher le mot de passe">üëÅ</button>
</div>
</label>
<menu>
<button type="button" class="ghost close-modal">Annuler</button>
<button id="li-submit" class="primary" value="default">Connexion</button>
</menu>
<div class="form-msg" id="li-msg"></div>
</form>
</dialog>

<!-- MODAL: Upload preuve -->
<dialog id="modal-proof">
<form method="dialog" class="modal-card" id="proof-form">
<h3>Envoyer une preuve (facultatif)</h3>
<p>Masquez les infos inutiles (notes, adresse‚Ä¶). La preuve est supprim√©e automatiquement sous 72 h.</p>
<label>Photo carnet<input type="file" id="pf-file" accept="image/*" required /></label>
<menu>
<button type="button" class="ghost close-modal">Fermer</button>
<button id="pf-submit" class="primary" value="default">Envoyer</button>
</menu>
<div class="form-msg" id="pf-msg"></div>
</form>
</dialog>

<!-- MODAL: Annuaire -->
<dialog id="modal-directory">
<div class="modal-card directory-card">
<div class="dir-header">
<h3>Annuaire du lyc√©e</h3>
<input type="search" id="dir-q" placeholder="Rechercher un pr√©nom, un nom ou une classe‚Ä¶" />
</div>
<ul id="dir-list" class="dir-list"></ul>
<menu>
<button type="button" class="ghost close-modal">Fermer</button>
<button id="dir-create" class="primary" title="Bient√¥t : cr√©er un groupe/MP" disabled>Cr√©er un groupe (bient√¥t)</button>
</menu>
</div>
</dialog>
</body>
</html>
